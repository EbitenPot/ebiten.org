<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    
    <meta name="description" content="Ebiten is an open-source game library, with which you can develop 2D games with simple API for multi platforms in the Go programming language.">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#db5620">
    <meta property="og:title" content="Geometry Matrix - Ebiten">
    <meta property="og:site_name" content="Ebiten - A dead simple 2D game library in Go">
    <meta property="og:image" content="https://ebiten.org/images/share.png">
    <meta property="og:description" content="Ebiten is an open-source game library, with which you can develop 2D games with simple API for multi platforms in the Go programming language.">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@hajimehoshi">
    <meta name="twitter:title" content="Geometry Matrix - Ebiten">
    <meta name="twitter:description" content="Ebiten is an open-source game library, with which you can develop 2D games with simple API for multi platforms in the Go programming language.">
    <meta name="twitter:image" content="https://ebiten.org/images/share.png">
    <title>Geometry Matrix - Ebiten</title>
    <link rel="canonical" href="https://ebiten.org/documents/geometrymatrix.html">
    <link href="https://fonts.googleapis.com/css?family=Roboto:400,700%7cRoboto+Mono:400,700&amp;display=swap" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="/styles/normalize.min.css">
    <link rel="stylesheet" type="text/css" href="/styles/style.css">
    <link rel="icon" href="/images/favicon.png" type="image/png">
    
    <script src="/scripts/script.js" defer></script>
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-83252440-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-83252440-1');
    </script>
  </head>
  <body>
    <input type="checkbox" id="sidemenu"><label for="sidemenu" class="sidemenubutton"></label><label for="sidemenu" class="sidemenucover"></label>
    <nav>
      <h1><a href="/">Ebiten</a></h1>
      <ul>
        <li><a href="/">Home</a></li>
        <li><a href="https://github.com/hajimehoshi/ebiten">GitHub project</a></li>
        <li><a href="https://godoc.org/github.com/hajimehoshi/ebiten">API reference</a></li>
        <li><a href="/documents/">Documents</a></li>
        <li><a href="/examples/">Examples</a></li>
        <li><a href="/blog/">Blog</a></li>
      </ul>
      <h2>Documents</h2>
<h3>Getting Started</h3>
<ul>
  <li><a href="./install.html">Install</a></li>
  <li><a href="./helloworld.html">Hello, World!</a></li>
</ul>
<h3>Graphics</h3>
<ul>
  <li><a href="./fill.html">Fill</a></li>
  <li><a href="./renderimage.html">Render an Image</a></li>
  <li><a href="./geometrymatrix.html">Geometry Matrix</a></li>
  <li><a href="#">Filter (TBD)</a></li>
  <li><a href="#">Offscreen (TBD)</a></li>
  <li><a href="#">Color Matrix (TBD)</a></li>
  <li><a href="#">Tiling (TBD)</a></li>
</ul>
<h3>Input</h3>
<ul>
  <li><a href="#">Keyboard (TBD)</a></li>
  <li><a href="#">Mouse (TBD)</a></li>
  <li><a href="#">Gamepad (TBD)</a></li>
</ul>
<h3>Building</h3>
<ul>
  <li><a href="./mobile.html">Mobile</a></li>
  <li><a href="./webassembly.html">WebAssembly</a></li>
  <li><a href="./gopherjs.html">GopherJS</a></li>
</ul>
<h3>Tips</h3>
<ul>
  <li><a href="./cheatsheet.html">Cheat Sheet</a></li>
  <li><a href="./faq.html">FAQ</a></li>
  <li><a href="./performancetips.html">Performance Tips</a></li>
  <li><a href="./packages.html">Packages</a></li>
  <li><a href="./implementation.html">Implementation</a></li>
</ul>

    </nav>
    <main>
      <article>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
<h1>Geometry Matrix</h1>
<h2>Code</h2>
<pre data-codesrc="/go/geometrymatrix/main.go"></pre>
<div class="grid-container">
  <div class="grid-item-2">
    <p>To execute this program, you need the image file <code>gopher.png</code> at the same directory:</p>
  </div>
  <div class="grid-item-2">
    <p class="img"><img src="/go/geometrymatrix/gopher.png" width="240" height="240" alt="Gopher"></p>
  </div>
</div>
<div class="grid-container">
  <div class="grid-item-2">
    <p>The result will be like this:</p>
  </div>
  <div class="grid-item-2">
    <p class="img screenshot"><img src="/images/go/geometrymatrix.png" width="320" height="240" alt="Screenshot"></p>
  </div>
</div>
<h2>How the code works</h2>
<div class="grid-container">
  <div class="grid-item-2">
    <pre data-codesrc="/go/geometrymatrix/main.go" data-codelinerange="25-28"></pre>
  </div>
  <div class="grid-item-2">
    <p>The program is almost same as <a href="renderimage.html">render-an-image example</a>. The difference is whether <a href="https://godoc.org/github.com/hajimehoshi/ebiten#DrawImageOptions"><code>DrawImageOptions</code></a> is specified or not at the <a href="https://godoc.org/github.com/hajimehoshi/ebiten#Image.DrawImage"><code>DrawImage</code></a> call. In this example, a <a href="https://godoc.org/github.com/hajimehoshi/ebiten#GeoM"><code>GeoM</code></a> is adjusted. <code>GeoM</code> represents <a href="https://en.wikipedia.org/wiki/Affine_transformation">an affine matrix</a> to translate, scale or rotate the image.</p>
    <p>In this example, the image is translated by $(50, 50)$ first, and scaled by $(1.5, 1)$. In Ebiten, Y axis is not upward but downward. Then, tralslating by $(50, 50)$ means that the image is moved by 50 pixels rightward, and by 50 pixels downward. For scaling, the origin point is upper-left and the directions are also downward and rightward.</p>
  </div>
  <div class="grid-item-2">
    <p>\begin{equation}
\begin{bmatrix}
  a & b & t_x \\
  c & d & t_y \\
  0 & 0 & 1 \\
\end{bmatrix}
\end{equation}</p>
  </div>
  <div class="grid-item-2">
    <p>While <code>GeoM</code> is an matrix for 2D dimension, <code>GeoM</code>'s dimension is 3. It is because <code>GeoM</code> is an affine matrix, which can represent not only scaling or rotating, but also translating. While scaling and rotating don't change the origin point (upper-left), translating does, and such change cannot be achieved with a non-affine 2-dimension matrix. The last row is always $(0, 0, 1)$.</p>
    <p>The geometry matrix is used to determine how to convert the position in the source image to the position in the destination image. In other words, the geometry matrix represents a converting rule of positions. By adjusting the geometry matrix, we can adjust how to render the source image on the destination image.</p>
  </div>
  <div class="grid-item-2">
    <p class="mathjax">\begin{equation}
\begin{bmatrix}
  1 & 0 & 0 \\
  0 & 1 & 0 \\
  0 & 0 & 1 \\
\end{bmatrix}
\end{equation}</p>
    <p class="img"><img src="/images/documents/geometrymatrix/identity.png" width="456"></p>
  </div>
  <div class="grid-item-2">
    <p>The initial value of <code>GeoM</code> represents an identity matrix. This means that nothing was changed. In Ebiten, the default location is the upper-left corner.</p>
    <p>Note that the direction of the Y axis is downward, not upward. This is different from usual mathematics, but is natural for 2D image rendering.</p>
  </div>
  <div class="grid-item-2">
    <p class="mathjax">\begin{equation}
\begin{bmatrix}
  s_x & 0 & 0 \\
  0 & s_y & 0 \\
  0 & 0 & 1 \\
\end{bmatrix}
g
\end{equation}</p>
    <p class="img"><img src="/images/documents/geometrymatrix/scale.png" width="456"></p>
  </div>
  <div class="grid-item-2">
    <p><a href="https://godoc.org/github.com/hajimehoshi/ebiten#GeoM.Scale"><code>(g *GeoM).Scale</code></a> left-multiplies a scaling geometry matrix. The origin position is the upper-left corner of the destination image.</p>
    <p>If the multiplicand is identity, the image is scaled by the <code>Scale</code> arguments without changing the position of the left-upper corner.
  </div>
  <div class="grid-item-2">
    <p class="mathjax">\begin{equation}
\begin{bmatrix}
  1 & 0 & t_x \\
  0 & 1 & t_y \\
  0 & 0 & 1 \\
\end{bmatrix}
g
\end{equation}</p>
    <p class="img"><img src="/images/documents/geometrymatrix/translate.png" width="456"></p>
  </div>
  <div class="grid-item-2">
    <p><a href="https://godoc.org/github.com/hajimehoshi/ebiten#GeoM.Translate"><code>(g *GeoM).Translate</code></a> left-multiplies a translating geometry matrix.</p>
    <p>If the multiplicand is identity, the image is moved from the left-upper corner by the <code>Translate</code> arguments.
  </div>
  <div class="grid-item-2">
    <p class="mathjax">\begin{equation}
\begin{bmatrix}
  \cos(\theta) & -\sin(\theta) & 0 \\
  \sin(\theta) & \cos(\theta) & 0 \\
  0 & 0 & 1 \\
\end{bmatrix}
g
\end{equation}</p>
    <p class="img"><img src="/images/documents/geometrymatrix/rotate.png" width="456"></p>
  </div>
  <div class="grid-item-2">
    <p><a href="https://godoc.org/github.com/hajimehoshi/ebiten#GeoM.Rotate"><code>(g *GeoM).Rotate</code></a> left-multiplies a rotating geometry matrix. The origin position is the upper-left corner of the destination image.</p>
    <p>If the multiplicand is identity, the image is rotated by the <code>Rotate</code> arguments. The center of rotating is the left-upper corner.
  </div>
  <div class="grid-item-4">
    <p>Of course you can combinate multiple operations of a geometry matrix. They are represented as multiplication of matrices. Note that the order of multiplication matters. For example, the result of translating then rotating an image is, in general, different from rotating then translating the image.</p>
  </div>
  <div class="grid-item-2">
    <p class="mathjax">\begin{equation}
\begin{bmatrix}
  1 & 0 & t_x \\
  0 & 1 & t_y \\
  0 & 0 & 1 \\
\end{bmatrix}
\begin{bmatrix}
  \cos(\theta) & -\sin(\theta) & 0 \\
  \sin(\theta) & \cos(\theta) & 0 \\
  0 & 0 & 1 \\
\end{bmatrix}
\end{equation}</p>
    <p class="img"><img src="/images/documents/geometrymatrix/rotate_translate.png" width="456"></p>
  </div>
  <div class="grid-item-2">
    <p class="mathjax">\begin{equation}
\begin{bmatrix}
  \cos(\theta) & -\sin(\theta) & 0 \\
  \sin(\theta) & \cos(\theta) & 0 \\
  0 & 0 & 1 \\
\end{bmatrix}
\begin{bmatrix}
  1 & 0 & t_x \\
  0 & 1 & t_y \\
  0 & 0 & 1 \\
\end{bmatrix}
\end{equation}</p>
    <p class="img"><img src="/images/documents/geometrymatrix/translate_rotate.png" width="456"></p>
  </div>
</div>

      </article>
      <footer>
        <p>Feedback about this page? <a href="https://github.com/ebiten/ebiten.org/issues/new?body=https%3a%2f%2febiten.org%2fdocuments%2fgeometrymatrix.html%0a%0a">Please reach out on GitHub</a>. Thank you!</p>
      </footer>
    </main>
  </body>
</html>
